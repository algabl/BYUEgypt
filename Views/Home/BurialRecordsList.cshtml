@inject UserManager<IdentityUser> UserManager
@inject SignInManager<IdentityUser> SignInManager

@model BurialmainsViewModel 

@{
    ViewData["Title"] = "Burial Summaries";
    var currentUser = UserManager.GetUserAsync(User).Result;
}

<section style="">
        <div class="d-flex justify-content-center align-items center w-auto cairo-font">
            
        </div>
        <div class="d-flex mt-5 mb-3 justify-content-center align-items center w-auto cairo-font">
            <div class="accordion accordion-flush w-75 " id="accordionFlushExample">
                <div class="accordion-item ">
                  <h2 class="accordion-header bg-primary text-light display-6">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseOne" aria-expanded="false" aria-controls="flush-collapseOne">
                      Current Burials - click to Filter
                    </button>
                  </h2>
                  <div id="flush-collapseOne" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
                      <div class="accordion-body">
                          <form class="row g-3" method="post" asp-action="BurialRecordsList" asp-controller="Home">
                            <div class="col-md-3">
                              <label for="Sex" class="form-label">Sex</label>
                              <select name="Sex" id="Sex" class="form-select">
                                <option value="" selected>Choose...</option>
                                <option value="F">Female</option>
                                <option value="M">Male</option>
                                <option value="U">Unknown</option>
                              </select>
                            </div>
                            <div class="col-md-3">
                              <label for="indicatorSex" class="form-label">Is... </label>
                              <select name="indicatorSex" id="indicatorSex" class="form-select">
                                <option value="==">Equal To</option>
                                <option value="!=">Is not Equal To</option>
                              </select>
                            </div>
                            <div class="col-md-3">
                              <label for="Depth" class="form-label">Depth</label>
                              <input type="number" name="Depth" id="Depth" class="form-control" step="0.01">
                            </div>
                            <div class="col-md-3">
                              <label for="indicatorDepth" class="form-label">Is... </label>
                              <select name="indicatorDepth" id="indicatorDepth" class="form-select">
                                <option value="==">Equal To</option>
                                <option value="!=">Is not Equal To</option>
                                <option value=">">Greater Than</option>
                                <option value="<">Less Than</option>
                                </select>
                            </div>
                            <div class="col-12">
                              <button type="submit" class="btn btn-primary">Filter</button>
                            </div>
                          </form>
                      </div>
                  </div>
                </div>
              </div>  
          <div class="col-1">
            @if (SignInManager.IsSignedIn(User))
            {
              if (await UserManager.IsInRoleAsync(currentUser, "USER") || await UserManager.IsInRoleAsync(currentUser, "ADMIN"))
              {
                <a class=" mt-2 btn btn-primary" asp-controller="Home" asp-action="CreateRecord">Add new</a>
              }
              
            }
          </div>
        </div>
        <div class="container col-10">
            @foreach (var bm in Model.Burialmains)
            {
                <partial name="BurialSummary" model="bm"/>
            }
        </div>

        <div page-burials="@Model.PageInfo" page-action="Index" page-class="btn" 
        page-class-normal="btn-outline-dark" page-class-selected="btn-info" page-classes-enabled="true"
        class="btn-group pull-right m-1"></div>
    </section>